<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <ui:composition>
        <h:form prependId="false">
            <p:panelGrid id="packagePanel" styleClass="transparent" style="margin: auto;">
                <p:row>
                    <p:column>
                        <p:outputLabel for="amount" value="小包数量："/>
                    </p:column>
                    <p:column>
                        <p:spinner id="amount" value="#{packScanner.amount}"
                                   size="3" min="20" max="200" stepFactor="10">
                            <p:ajax process="@this" update="amount"/>
                        </p:spinner>
                    </p:column>
                </p:row>
                <p:row>
                    <p:column>
                        <p:outputLabel for="packCodeInputForPackage" value="条码输入："/>
                    </p:column>
                    <p:column>
                        <p:inputText id="packCodeInputForPackage"
                                     value="#{packScanner.packCode}"/>
                        <p:focus for="packCodeInputForPackage"/>
                    </p:column>
                    <p:column>
                        <p:commandButton id="packCodeInputForPackageAddButton" value="添加" action="#{packScanner.addPackCode}"
                                         process="packCodeInputForPackage @this"
                                         update="packCodeInputForPackage bulkPackCode smallPackCodes"
                                         oncomplete="PrimeFaces.focus('packCodeInputForPackage');"/>
                    </p:column>
                </p:row>
                
                <p:row>
                    <p:column>
                        <p:outputLabel for="selectSeedId" value="种子批次："/>
                    </p:column>
                    <p:column>
                        <p:selectOneMenu id="selectSeedId" value="#{packScanner.seedId}" 
                                             style="font-size: 90%;">
                            <f:selectItems value="#{seedManager.seeds}"
                                           var="seed" itemLabel="#{seed.seedUiDisplay}" itemValue="#{seed.id}"/>
                        </p:selectOneMenu>
                    </p:column>
                </p:row>
                
                <p:row>
                    <p:column>
                        <p:outputLabel for="bulkPackCode" value="大包条码："/>
                    </p:column>
                    <p:column>
                        <p:inputText id="bulkPackCode" disabled="true"
                                     value="#{packScanner.bulkPackCode}"/>
                    </p:column>
                </p:row>
                <p:row>
                    <p:column>
                        <h:outputText value="小包条码："/>
                    </p:column>
                    <p:column colspan="2">
                        <p:scrollPanel mode="native" style="height: 200px;">
                            <p:dataList id="smallPackCodes" type="ordered"
                                        value="#{packScanner.smallPackCodes}"
                                        var="smallPackCode" emptyMessage="尚未添加小包条码。">
                                <h:outputText value="#{smallPackCode}"/>
                            </p:dataList>
                        </p:scrollPanel>
                    </p:column>
                </p:row>
                <p:row>
                    <p:column colspan="3">
                        <h:panelGroup layout="block" styleClass="submit">
                            <p:commandButton id="bindPackageCodes" value="绑定" action="#{packScanner.bindCodes}"
                                             process="amount selectSeedId bulkPackCode @this"
                                             update="packCodeInputForPackage bulkPackCode smallPackCodes"
                                             oncomplete="PrimeFaces.focus('packCodeInputForPackage');"/>
                        </h:panelGroup>
                    </p:column>
                </p:row>
            </p:panelGrid>
            
            <p:blockUI block="packagePanel" trigger="bindPackageCodes" > 数据保存中...</p:blockUI>
        </h:form>
    </ui:composition>
</html>
